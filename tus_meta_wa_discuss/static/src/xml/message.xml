<?xml version="1.0" encoding="UTF-8"?>
<templates id="template_ext" xml:space="preserve">
    <t t-name="MessageExt" t-inherit="mail.Message" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[@t-if='messageView.messageActionList and !messageView.composerViewInEditing']" position="replace">
             <div t-if="messageView.messageActionList and !messageView.composerViewInEditing and messageView.threadView and messageView.threadView.thread and !messageView.threadView.thread.isWaMsgs" class="o_Message_actionListContainer pl-5 pr-3" t-att-class="{ 'o-squashed': messageView.isSquashed }">
                <MessageActionList messageActionListLocalId="messageView.messageActionList.localId"/>
            </div>
        </xpath>

        <!-- Add WhatsApp Icon for Every WhatsApp Message in Discuss, Chatter, Chat Window/Sidebar -->
        <xpath expr="//t[@t-if='messageView.message.failureNotifications.length > 0']//..//.." position="attributes">
            <attribute name="t-if">messageView.messageListViewItemOwner and messageView.message.originThread and messageView.message.originThread === messageView.messageListViewItemOwner.messageListViewOwner.threadViewOwner.thread and messageView.message.notifications.length > 0 and messageView.message.message_type != 'wa_msgs'</attribute>
        </xpath>
        <xpath expr="//t[@t-if='messageView.message.failureNotifications.length > 0']//..//.." position="after">
            <t t-if="messageView.message.message_type != 'notification'">
                <t t-if="messageView.messageListViewItemOwner and messageView.message.originThread and messageView.message.originThread === messageView.messageListViewItemOwner.messageListViewOwner.threadViewOwner.thread and (messageView.message.notifications.length == 0 or messageView.message.message_type == 'wa_msgs') and messageView.message.message_type != 'comment' or  (messageView.isInChatter and messageView.message.notifications.length == 0) ">
                    <div t-att-class="{ 'ms-2': messageView.isInChatWindowAndIsAlignedRight }">
                        <span class="o_Message_notificationIconClickable text-600 cursor-pointer" t-ref="notificationIcon_wat">
                                <i class="fa fa-whatsapp" t-att-class="messageView.notificationIconClassName"/> <span t-if="messageView.notificationIconLabel" t-out="messageView.notificationIconLabel"/>
                        </span>
                    </div>
                </t>
            </t>
        </xpath>


    </t>
</templates>
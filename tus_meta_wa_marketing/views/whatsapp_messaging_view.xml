<odoo>
    <record model="ir.ui.view" id="whatsapp_messaging_form_view">
        <field name="name">whatsapp.messaging.form</field>
        <field name="model">whatsapp.messaging</field>
        <field name="arch" type="xml">
            <form>
                <header style="min-height:31px;">
                        <button name="put_in_queue" type="object" attrs="{'invisible': [('state', 'in', ('in_queue', 'done'))]}" class="oe_highlight" string="Send Now"/>
                        <button name="action_schedule_date" type="object" attrs="{'invisible': [('state', 'in', ('in_queue', 'done'))]}" class="btn-secondary" string="Schedule"/>
<!--                        <button name="action_test_mailing" type="object" class="btn-secondary" string="Test"/>-->
                        <button name="cancel_mass_mailing" type="object" attrs="{'invisible': [('state', '!=', 'in_queue')]}" class="btn-secondary" string="Cancel"/>
<!--                        <button name="retry_failed_mail" type="object" attrs="{'invisible': ['|', ('state', '!=', 'done'), ('failed', '=', 0)]}" class="oe_highlight" string="Retry"/>-->

                        <field name="state" readonly="1" widget="statusbar"/>
                    </header>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="wa_messaging_model_id"/>
                        <field name="is_partner" invisible="1"/>
                        <field name="domain" attrs="{'invisible':[('is_partner','=',False)]}"/>
                        <field name="schedule_date" invisible="1"/>
                        <field name="partner_ids" widget="many2many_tags" attrs="{'invisible':['|',('domain','=',True),('is_partner','=',False)]}"/>
                        <field name="whatsapp_messaging_lists_ids" widget="many2many_tags" attrs="{'invisible':[('is_partner','=',True)]}"/>
                        <field name="wa_messaging_domain" widget="domain"
                                    options="{'model': 'res.partner'}" attrs="{'invisible':[('domain','=',False)]}">
                                </field>
                        <field name="company_id"/>
                        <field name="user_id" invisible="1"/>
                    </group>
                     <group>
                        <group>
                            <field name="provider_id" required="1"
                                   domain="[('company_id','=',company_id),('id','in',allowed_provider_ids)]"/>
                            <field name="allowed_provider_ids" invisible="1"/>
                        </group>
                        <group>
                            <field name="template_id" domain="[('provider_id','=',provider_id)]"/>
                        </group>
                    </group>

                    <group col="4">
                        <field name="attachment_ids" widget="many2many_binary" string="Attach a file" nolabel="1"
                               colspan="2"/>
                    </group>
                     <notebook>
                        <page string="Content" name="content">
                            <group>
<!--                                <field name="body_html" widget="html" options="{'style-inline': true, 'codeview': true }" nolabel="1"/>-->
                                <field name="body_html" widget="html" nolabel="1" colspan="2"/>
                            </group>
                        </page>
                         <page string="Whatsapp Messages" name="history">
<!--                            <group>-->
                                <field name="mail_history_ids" >
                                    <tree>
                                        <field name="provider_id"/>
                                        <field name="date"/>
                                        <field name="author_id"/>
                                        <field name="partner_id"/>
                                        <field name="phone"/>
                                        <field name="message"/>
                                        <field name="attachment_ids" widget="many2many_tags"/>
                                        <field name="type"/>
                                        <field name="fail_reason"/>
                                    </tree>
                                </field>
<!--                            </group>-->
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="whatsapp_messaging_tree_view">
        <field name="name">whatsapp.messaging.tree</field>
        <field name="model">whatsapp.messaging</field>
        <field name="arch" type="xml">
             <tree default_order="create_date desc">
                <field name="name"/>
                <field name="partner_ids" widget="many2many_tags"/>
                <field name="whatsapp_messaging_lists_ids" widget="many2many_tags"/>
                <field name="wa_messaging_model_id"/>
            </tree>
        </field>
    </record>

    <record model="ir.actions.act_window" id="whatsapp_messaging_action">
        <field name="name">Whatsapp Marketing</field>
        <field name="res_model">whatsapp.messaging</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="whatsapp_marketing_menu" name="Whatsapp Marketing" web_icon="tus_meta_wa_marketing,static/description/icon.png" groups="tus_meta_whatsapp_base.whatsapp_group_user"/>
    <menuitem id="whatsapp_messaging_sub_menu" name="Whatsapp Marketing" parent="whatsapp_marketing_menu" action="whatsapp_messaging_action"/>
</odoo>